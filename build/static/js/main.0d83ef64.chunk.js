(window["webpackJsonpchat-app"]=window["webpackJsonpchat-app"]||[]).push([[0],{17:function(e,t,n){e.exports=n(32)},22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){},32:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(2),o=n.n(s),i=(n(22),n(23),n(24),n(3)),c=n(4),u=n(8),m=n(5),l=n(9);n(25);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var f=r.a.createElement("g",null,r.a.createElement("g",null,r.a.createElement("g",{id:"send"},r.a.createElement("polygon",{points:"0,497.25 535.5,267.75 0,38.25 0,216.75 382.5,267.75 0,318.75   ","data-original":"#000000",className:"active-path","data-old_color":"#000000",fill:"#878181"})))),d=function(e){var t=e.svgRef,n=e.title,a=p(e,["svgRef","title"]);return r.a.createElement("svg",h({id:"Capa_1",x:"0px",y:"0px",width:"512px",height:"512px",viewBox:"0 0 535.5 535.5",style:{enableBackground:"new 0 0 535.5 535.5"},xmlSpace:"preserve",ref:t},a),r.a.createElement("title",null,n),f)},g=r.a.forwardRef(function(e,t){return r.a.createElement(d,h({svgRef:t},e))}),v=(n.p,"FETCHED_CHATROOM"),b="SEND_COMMENT",y={comments:[],users:[]};function C(e){var t={};return e&&e.users?(e.users.map(function(e){return t[e.id]=e}),e.posts.map(function(e){var n=new Date(1e3*e.ts);return e.user=t[e.user],e.timeAgo=n.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),e.message=w(e.message),e}),e):e}function E(e){if(e){var t=new Date;return{id:t.getTime(),user:-1,local:!0,message:w(e),timeAgo:t.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})}}console.warn("Creating a comment requires a message")}function w(e){if(!e)return e;var t=/((http(s?)(:\/\/))?(([w]{3}|(.*))\.)?([a-zA-Z|0-9])+\.(com(\.au)?|org|me|net|ly|be|gl|co|it|info|(co(\.))?uk|ca|nz|tv)(\/[^\s]+)*)+/g,n=e.indexOf("<"),a=n>-1?e.substr(0,n):e,r=n>-1?e.substr(n):"";return a.split(" ").map(function(e){return e.replace(t,function(e){return'<a href="'+("http"!==e.substr(0,4)?"http://"+e:e).replace(/("|').*$/g,"")+'" target="_blank" rel="nofollow noreferrer noopener">'+e.replace(/("|').*$/g,"")+"</a>"})}).join(" ")+r}var O=function(e){return{type:v,response:e}},x=function(e){return{type:b,message:e}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:var n=C(t.response);return{comments:n.posts,users:n.users};case b:return e.comments.push(E(t.message)),e;default:return e}},j=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).maxCharacterCount=140,n.placeholderText="whats happening",n.state={inputValue:"",remainingCharacterCount:n.maxCharacterCount},n}return Object(l.a)(t,e),Object(c.a)(t,[{key:"sendButtonClicked",value:function(){this.isInputInvalid()?alert("The character limit is "+this.maxCharacterCount+". Please edit your message and try again."):this.isInputEmpty()?alert("The message is empty. Please add a message and try again."):this.sendComment()}},{key:"onInputChanged",value:function(e){if(e&&e.target&&void 0!==e.target.innerText?e.target:void 0){var t=""===e.target.innerText?this.placeholderText:e.target.innerText;this.setState({inputValue:t,remainingCharacterCount:this.remainingCharacterCount(e.target.innerText.length)})}}},{key:"onKeyDown",value:function(e){13===e.keyCode&&(this.sendComment(),e.preventDefault())}},{key:"isInputInvalid",value:function(){if(this.state.remainingCharacterCount<0)return!0}},{key:"isInputEmpty",value:function(){return 0===this.state.inputValue.length||this.state.inputValue===this.placeholderText}},{key:"render",value:function(){var e=this,t="remaining-character-count font-theme",n="send-button-image";return this.isInputInvalid()?t+=" error":this.isInputEmpty()||(n+=" send-button-active"),r.a.createElement("div",{className:"chat-input"},r.a.createElement("span",{className:t},this.state.remainingCharacterCount),r.a.createElement("div",{contentEditable:"true","data-text":this.placeholderText,className:"input font-theme",onInput:function(t){return e.onInputChanged(t)},onKeyDown:function(t){return e.onKeyDown(t)},ref:function(t){return e.textArea=t}}),r.a.createElement("button",{onClick:function(){return e.sendButtonClicked()},className:"send-button font-theme"},r.a.createElement(g,{alt:"",className:n,width:"25px",height:"25px"})))}},{key:"remainingCharacterCount",value:function(e){return e?this.maxCharacterCount-e:this.maxCharacterCount}},{key:"sanitizeInput",value:function(){return this.state.inputValue.replace(/<[^>]*>/g," ").replace(/\s{2,}/g," ").trim()}},{key:"sendComment",value:function(){if(!this.isInputInvalid())if(this.props.store){var e=this.sanitizeInput();this.props.store.dispatch(x(e));var t={comment:e};fetch("http://localhost:3000/chat",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),this.textArea.innerText="",this.setState({inputValue:"",remainingCharacterCount:this.maxCharacterCount})}else console.warn("ChatInputComponent is misconfigured, requires a store")}}]),t}(r.a.Component),N=(n(26),function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(!this.props.comment||!this.props.comment.user)return null;var e="chat-comment";return this.props.comment.local&&(e+=" own-comment"),r.a.createElement("li",null,r.a.createElement("div",{className:e},this.thumbnailImage(),r.a.createElement("div",{className:"chat-comment-message-wrapper"},r.a.createElement("div",{className:"message-top"},r.a.createElement("div",{className:"chat-comment-username font-theme truncate"},this.props.comment.user.real_name," - @",this.props.comment.user.username),r.a.createElement("div",{className:"chat-comment-time font-theme"},this.props.comment.timeAgo)),r.a.createElement("div",{className:"message-bottom font-theme"},r.a.createElement("div",{className:"message-frontside",dangerouslySetInnerHTML:{__html:this.props.comment.message}}),r.a.createElement("div",{className:"message-backside"},r.a.createElement("img",{className:"message-backside-icon",alt:"",src:"./assets/calendar-icon.svg"}),"active since July 13, 2017")))))}},{key:"thumbnailImage",value:function(){return this.props.comment.local?r.a.createElement("div",{className:"chat-comment-thumb-wrapper chat-local-thumb-wrapper"},r.a.createElement("div",{className:"chat-comment-thumb"},r.a.createElement("img",{alt:"",src:"./assets/better-icon.svg"}))):r.a.createElement("div",{className:"chat-comment-thumb-wrapper"},r.a.createElement("img",{alt:"",className:"chat-comment-thumb",src:"./assets/"+this.props.comment.user.username+".jpg"}))}}]),t}(r.a.Component)),I=n(34),T=n(35),S=(n(27),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).listEl=null,n.state={comments:[]},n}return Object(l.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.store.subscribe(function(){if(e.props.store){var t=e.props.store.getState();e.setState({comments:t.comments?t.comments:[]})}}),this.fetchChatRoom()}},{key:"componentDidUpdate",value:function(){var e=o.a.findDOMNode(this.listEl);e&&(e.scrollTop=e.scrollHeight)}},{key:"fetchChatRoom",value:function(){var e=this;fetch("http://localhost:3000/chatRoom").then(function(e){return e.json()}).then(function(t){t&&t.posts&&e.props.store.dispatch(O(t))})}},{key:"render",value:function(){var e=this;if(0===this.state.comments.length)return null;var t=this.state.comments.map(function(e){return r.a.createElement(I.a,{classNames:"chat-comment",key:e.id,timeout:500,appear:!0},r.a.createElement(N,{comment:e}))});return r.a.createElement(T.a,{className:"chat-list",component:"ul",ref:function(t){return e.listEl=t}},t)}}]),t}(r.a.Component)),D=n(14),R=Object(D.a)(k);var _=function(){return r.a.createElement("div",{className:"container"},r.a.createElement(S,{store:R}),r.a.createElement(j,{store:R}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[17,1,2]]]);
//# sourceMappingURL=main.0d83ef64.chunk.js.map